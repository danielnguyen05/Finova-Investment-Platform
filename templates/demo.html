<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Data Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .graph-container {
            width: 80%;
            margin: auto;
        }
        img {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>

    <h1>Financial Data Dashboard</h1>

    <!-- Company Selection -->
    <label for="company">Select a Company:</label>
    <select id="company">
        <option value="IBM">IBM</option>
        <option value="AAPL">Apple</option>
        <option value="NVDA">NVIDIA</option>
        <option value="TSLA">Tesla</option>
        <option value="JPM">JPMorgan Chase</option>
    </select>
    <button onclick="fetchGraphs()">Get Data</button>

    <hr>

    <h2>Company Dividend Trends</h2>
    <img id="dividendsGraph" src="/static/company_dividends_plot.png" alt="Company Dividend Trends Graph">

    <h2>Real GDP Over Time</h2>
    <img id="gdpGraph" src="/static/real_gdp_plot.png" alt="Real GDP Graph">

    <h2>Real GDP Per Capita Over Time</h2>
    <img id="gdpPerCapitaGraph" src="/static/real_gdp_per_capita_plot.png" alt="Real GDP Per Capita Graph">

    <script>
        function fetchGraphs() {
            const company = document.getElementById("company").value;
    
            fetch("/api/graphs", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ company })
            })
            .then(response => response.json())
            .then(data => {
                console.log("API Response:", data);

                // Update images with cache-busting timestamps
                document.getElementById("dividendsGraph").src = data.dividends_url;
                document.getElementById("gdpGraph").src = data.gdp_url;
                document.getElementById("gdpPerCapitaGraph").src = data.gdp_per_capita_url;
            })
            .catch(error => console.error("Error fetching graphs:", error));
        }
    </script>

</body>
</html>
